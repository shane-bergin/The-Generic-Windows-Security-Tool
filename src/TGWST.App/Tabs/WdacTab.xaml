<UserControl x:Class="TGWST.App.Tabs.WdacTab" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" xmlns:conv="clr-namespace:TGWST.App.Converters">
    <UserControl.Resources>
        <conv:NullToBoolConverter x:Key="NullToBool"/>
    </UserControl.Resources>
    <Grid Margin="8">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <TextBlock Grid.Row="0"
                   Margin="0,0,0,8"
                   TextWrapping="Wrap"
                   Text="Select a WDAC policy and click Apply to enforce it. Policies are loaded from the TGWST WDAC folder and any existing system policies."/>

        <StackPanel Grid.Row="1" Margin="0,0,0,8">
            <ComboBox
                      ItemsSource="{Binding Policies}"
                      DisplayMemberPath="DisplayName"
                      SelectedItem="{Binding SelectedPolicy, Mode=TwoWay}"
                      Margin="0,0,0,4"/>
            <TextBlock Text="Select a WDAC policy and click Apply to enforce it. Policies are loaded from the TGWST WDAC folder and any existing system policies."
                       TextWrapping="Wrap"
                       FontStyle="Italic"
                       FontSize="12"
                       Margin="0,0,0,4"/>
            <StackPanel Orientation="Horizontal">
                <CheckBox Content="Enforce (UMCI)" IsChecked="{Binding EnforceUmci}" Margin="0,0,8,0"/>
                <Button Content="Apply WDAC" Click="Apply_Click" Margin="0,0,8,0" IsEnabled="{Binding SelectedPolicy, Converter={StaticResource NullToBool}}"/>
                <Button Content="Remove WDAC" Click="Remove_Click" IsEnabled="{Binding HasActivePolicy}"/>
            </StackPanel>
        </StackPanel>

        <TextBlock Grid.Row="2" Text="{Binding Status}" />
    </Grid>
</UserControl>
