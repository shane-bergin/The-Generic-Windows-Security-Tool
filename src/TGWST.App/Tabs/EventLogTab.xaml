<UserControl x:Class="TGWST.App.Tabs.EventLogTab" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
    <Grid Margin="8">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <TextBlock Grid.Row="0"
                   Margin="0,0,0,8"
                   TextWrapping="Wrap"
                   Text="Scan recent Windows event logs for suspicious or security-relevant activity. Choose a lookback period and click Scan Events."/>

        <StackPanel Grid.Row="1" Margin="0,0,0,8">
            <StackPanel Orientation="Horizontal" Margin="0,0,0,4">
                <TextBlock Text="Lookback:" VerticalAlignment="Center" Margin="0,0,8,0"/>
                <ComboBox Width="160"
                          ItemsSource="{Binding LookbackChoices}"
                          DisplayMemberPath="Name"
                          SelectedItem="{Binding SelectedLookbackChoice, Mode=TwoWay}"/>
                <Button Content="Scan Events" Margin="8,0,0,0" Click="Scan_Click"/>
            </StackPanel>
            <TextBlock Text="{Binding RunContextDescription}" FontStyle="Italic" FontSize="12"/>
        </StackPanel>

        <DataGrid Grid.Row="2"
                  ItemsSource="{Binding Findings}"
                  AutoGenerateColumns="False"
                  IsReadOnly="True">
            <DataGrid.Columns>
                <DataGridTextColumn Header="Time" Binding="{Binding TimeCreated}" Width="Auto"/>
                <DataGridTextColumn Header="EventId" Binding="{Binding EventId}" Width="Auto"/>
                <DataGridTextColumn Header="Rule" Binding="{Binding Rule}" Width="Auto"/>
                <DataGridTextColumn Header="Source" Binding="{Binding Source}" Width="*"/>
                <DataGridTextColumn Header="Message" Binding="{Binding Message}" Width="2*"/>
            </DataGrid.Columns>
        </DataGrid>

        <TextBlock Grid.Row="3"
                   Margin="0,8,0,0"
                   Text="{Binding Status}"/>
    </Grid>
</UserControl>
